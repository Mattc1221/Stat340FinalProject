---
title: "Stat340_Final"
author: "Matthew Chiang, Ishaan Backliwal, Jordan Livingston, Eric Dietze, Vu Pham"
date: "11/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, include=FALSE}
library(dplyr)
library(tidyverse)
library(ggplot2)
# install.packages("cowplot")
library(cowplot)
```


# Loading Data

```{r loading data, include=FALSE}
astros_home <- read.csv("./data/astros_2017_player_splits_home.csv") %>%
  mutate(Name = str_split_fixed(Name, "\\\\", 2)[,1]) %>%
  mutate(split = "HOME")

astros_away <- read.csv("./data/astros_2017_player_splits_away.csv")%>%
  mutate(Name = str_split_fixed(Name, "\\\\", 2)[,1]) %>%
  mutate(split = "AWAY")

astros_2017 <- rbind(astros_home[-length(astros_home[,1]),], astros_away[-length(astros_away[,1]),])
```

### Astros 2017 Home Data

```{r, echo=FALSE}
head(astros_home)
```

### Astros 2017 Away Data

```{r, echo=FALSE}
head(astros_away)
```

# Preliminary Graphs - Home vs. Away

### comparing specific variables
```{r}
ops <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=OPS, fill=split)) + 
    theme(legend.position = "none")
runs <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=R, fill=split)) + 
    theme(legend.position = "none")
hits <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=H, fill=split)) + 
    theme(legend.position = "none")
batting_avg <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=BA, fill=split)) + 
    theme(legend.position = "none")
home_run <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=HR, fill=split)) + 
    theme(legend.position = "none")
rbi <- astros_2017 %>%
  drop_na() %>%
  ggplot() +
    geom_boxplot(aes(x=RBI, fill=split))

plot_grid(ops, runs, hits, batting_avg, home_run, rbi, ncol=2)
```
```{r}
run_data <- astros_2017 %>%
  drop_na() %>%
  select(R)
run_data
```



